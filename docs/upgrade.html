<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TasteBase - Upgrade</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

    <div class="topbar">
        <div class="topbar-left" id="nav-home">
            <div class="logo-circle">TB</div>
            <div class="app-name">TasteBase</div>
        </div>
        <div class="topbar-right">
            <span class="badge" id="nav-current">Upgrade</span>
            <button class="btn-outline" id="nav-profile">Profile</button>
            <button class="btn" id="nav-logout">Sign Out</button>
        </div>
    </div>

    <div class="page">
        <div class="page-title">Upgrade Your Account</div>
        <div class="subtle">
            Premium unlocks Smart Add (AI recipe generation), favorites filtering,
            and enhanced recipe storage.
        </div>

        <div class="form-card centered">
            <p>Upgrade now and unlock Smart Add!</p>
            <button class="btn" id="upgrade-btn">Upgrade to Premium</button>
        </div>

        <div class="subtle" id="result" style="margin-top:1rem;"></div>
    </div>

    <script>
        const API_BASE = "https://tastebase-api.onrender.com";
        const token = localStorage.getItem('token');
        if (!token) location.href = 'login.html';

        // NAV
        document.getElementById("nav-home").onclick = () => location.href = "home.html";
        document.getElementById("nav-profile").onclick = () => location.href = "profile.html";
        document.getElementById("nav-logout").onclick = () => {
            localStorage.clear();
            location.href = "index.html";
        };

        document.getElementById("upgrade-btn").onclick = async () => {
            const res = await fetch(`${API_BASE}/api/upgrade`, {
                method: "POST",
                headers: { Authorization: "Bearer " + token }
            });

            if (res.ok) {
                document.getElementById("result").textContent = "You are now Premium!";
                setTimeout(() => location.href = "profile.html", 1200);
            } else {
                document.getElementById("result").textContent = "Upgrade failed.";
            }
        };
    </script>

</body>
</html>
