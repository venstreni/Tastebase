<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TasteBase - Set New Password</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

    <div class="page centered">
        <div class="page-title">Reset Password</div>

        <div class="form-card">
            <div class="form-group">
                <label>New Password</label>
                <input id="pw1" type="password">
            </div>

            <div class="form-group">
                <label>Confirm Password</label>
                <input id="pw2" type="password">
            </div>

            <button class="btn" id="reset-btn">Reset Password</button>
        </div>

        <div class="subtle" id="result"></div>
    </div>

    <script>
const params = new URLSearchParams(location.search);
const token = params.get("token");

document.getElementById("reset-btn").onclick = async () => {
    const p1 = document.getElementById("pw1").value.trim();
    const p2 = document.getElementById("pw2").value.trim();

    if (!p1 || !p2 || p1 !== p2) {
        document.getElementById("result").textContent = "Passwords must match.";
        return;
    }

    const res = await fetch("{API_BASE}/api/auth/reset", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ token, password: p1 })
    });

    if (res.ok) {
        document.getElementById("result").textContent = "Password updated!";
        setTimeout(() => location.href = "login.html", 1200);
    } else {
        document.getElementById("result").textContent = "Reset failed.";
    }
};
    </script>

</body>
</html>
